id: xml_users
label: 'user migration for local XML source example'
migration_tags:
  - XML Source
  - Users
source:
  constants:
    TITLE_SUFFIX: ' (Imported from local file)'
    ACTIVE: 1

  plugin: url

  # This configuration is ignored by the 'xml' data parser plugin.
  # It only has effect when using the 'simple_xml' data parser plugin.
  data_fetcher_plugin: file

  # Set to 'xml' to use XMLReader https://www.php.net/manual/en/book.xmlreader.php
  # Set to 'simple_xml' to use SimpleXML https://www.php.net/manual/en/ref.simplexml.php
  data_parser_plugin: xml

  urls:
    - modules/custom/custom_migrations/sources/users.xml

  # XPath expression. It is common that it starts with a slash (/).
  item_selector: /users/user
  fields:
    - name: src_unique_id
      label: 'Unique ID'
      selector: id
    - name: src_name
      label: 'Name'
      selector: name
    - name: src_email
      label: 'Email'
      selector: email
  ids:
    src_unique_id:
      type: integer
process:
  name:
    - plugin: machine_name
      source: src_name
    - plugin: make_unique_entity_field
      entity_type: user
      field: name
      postfix: _
    # plugin: concat
    # source:
    #   - src_name
    #   - constants/TITLE_SUFFIX
  mail: src_email
  init: src_email
  status:
    plugin: concat
    source:
      - constants/ACTIVE
  roles: authenticated
destination:
  plugin: 'entity:user'